{% extends 'nav_bar.html' %}
{% load static %}
{% block content %}
    <link rel="stylesheet" href="{% static 'css/main.css' %}">
<div class="movie-rating-container">
    {% if all_rated %}
        <div class="all-rated-section">
            <div class="congratulations-card">
                <h2>Congratulations!</h2>
                <p>You have rated all available movies.</p>
                <a href="{% url 'browse' %}" class="btn btn-browse">Browse Your Rooms</a>
            </div>
        </div>
    {% else %}
        <div class="movie-header">
            <h1 class="movie-title">{{ movie.title }}</h1>
            {% if movie.year %}
                <span class="movie-year">({{ movie.year }})</span>
            {% endif %}
        </div>
        
        <div class="movie-content">
            <div class="movie-poster-section">
                {% if movie.poster_url %}
                    <div class="poster-container">
                        <img src="{{ movie.poster_url }}" alt="Poster {{ movie.title }}" class="movie-poster">
                    </div>
                {% else %}
                    <div class="poster-placeholder">
                        <span>üé¨</span>
                        <p>No poster available</p>
                    </div>
                {% endif %}
            </div>

        
            <div class="movie-info-section">
                <div class="movie-background-overlay">
                    <div class="rating-stats">
                        {% if movie.total_ratings > 0 %}
                            <div class="average-score">
                                <span class="score-number">{{ movie.average_rating }}</span>
                                <span class="score-max">/3.0</span>
                            </div>
                            <div class="rating-count">{{ movie.total_ratings }} rating{{ movie.total_ratings|pluralize }}</div>
                        {% else %}
                            <div class="average-score">
                                <span class="score-number">‚Äî</span>
                            </div>
                            <div class="rating-count">No ratings yet</div>
                        {% endif %}
                    </div>
                
                    {% if movie.description %}
                        <div class="movie-description">
                            <h3>Description</h3>
                            <p>{{ movie.description }}</p>
                        </div>
                    {% endif %}
                
                    {% if youtube_embed_url %}
                        <div class="trailer-section">
                            <h3>Trailer</h3>
                            <div class="trailer-container">
                                <iframe src="{{ youtube_embed_url }}"
                                        frameborder="0"
                                        allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
                                        allowfullscreen>
                                </iframe>
                            </div>
                        </div>
                    {% elif movie.trailer_url %}
                        <div class="trailer-section">
                            <h3>Trailer</h3>
                            <a href="{{ movie.trailer_url }}" target="_blank" class="trailer-link">
                                ‚ñ∂Ô∏è Watch trailer
                            </a>
                        </div>
                    {% endif %}
                
                    <div class="rating-section">
                        <h3>What's your vibe?</h3>
                        <form method="post" class="rating-form">
                            {% csrf_token %}
                            
                            <div class="rating-buttons">
                                <button type="submit" name="rating" value="0" class="rating-btn dislike-btn">
                                    <span class="emoji">üëé</span>
                                    <span class="text">Don't like it</span>
                                </button>

                                <button type="submit" name="rating" value="1" class="rating-btn like-btn">
                                    <span class="emoji">üëç</span>
                                    <span class="text">Like it</span>
                                </button>

                                <button type="submit" name="rating" value="2" class="rating-btn love-btn">
                                    <span class="emoji">‚ù§Ô∏è</span>
                                    <span class="text">Love it</span>
                                </button>

                                <button type="submit" name="rating" value="watched" class="rating-btn watched-btn">
                                    <span class="emoji">‚úÖ</span>
                                    <span class="text">Already watched</span>
                                </button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    {% endif %}
</div>
{% endblock %}